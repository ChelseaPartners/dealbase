#!/bin/bash
# Pre-push hook: Run smoke tests for golden paths
# This prevents pushing code that breaks core functionality

set -e

echo "ğŸ” Running pre-push smoke tests..."

# Check if we're in the right directory
if [ ! -f "package.json" ]; then
    echo "âŒ Error: Not in project root directory"
    exit 1
fi

# Run TypeScript check
echo "ğŸ“ Checking TypeScript..."
pnpm typecheck || {
    echo "âŒ TypeScript check failed"
    exit 1
}

# Run linting
echo "ğŸ§¹ Running linter..."
pnpm lint || {
    echo "âŒ Linting failed"
    exit 1
}

# Run build check
echo "ğŸ—ï¸  Checking build..."
pnpm build || {
    echo "âŒ Build failed"
    exit 1
}

# Run fast unit tests
echo "ğŸ§ª Running unit tests..."
pnpm test || {
    echo "âŒ Unit tests failed"
    exit 1
}

echo "âœ… All pre-push checks passed!"
echo "ğŸš€ Ready to push!"
